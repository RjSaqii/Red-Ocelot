<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style/stylesheet.css">
    <script defer src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script defer src="./script/script.js"></script>
    <title>Bar Chart Visualization</title>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <h1><span class="red-text">Red</span><span class="white-text">Ocelot</span></h1>
        <div class="navbar-brand">
            <div id="dropdown-container">
                <label for="multioptions"><span class="white-text">Select Repository:</span></label>
                <select id="multioptions" name="multioptions"></select>
            </div>
        </div>
    </nav>

    <!-- Main Heading -->
    <h1>Bar Chart Visualization</h1>

    <!-- Chart Container -->
    <div id="barChart"></div>

    <!-- JavaScript -->
    <script>
        // Populate Dropdown and Initialize Bar Chart
        document.addEventListener("DOMContentLoaded", async () => {
            await populateDropDown();

            const repoOptions = document.getElementById("multioptions");

            // Add event listener for repository changes
            repoOptions.addEventListener("change", renderBarChart);
        });

        async function renderBarChart() {
            const currentRepoName = document.getElementById("multioptions").value;

            try {
                const plotData = await getBarPlots(currentRepoName);
                createChart(plotData, "barChart", "bar");
            } catch (error) {
                console.error("Error rendering bar chart:", error);
            }
        }

        async function populateDropDown() {
            try {
                const repoNameData = await getRepoNames();
                const select = document.getElementById("multioptions");

                // Clear existing options
                select.innerHTML = '';

                // Populate dropdown
                repoNameData.forEach((repo) => {
                    const option = document.createElement("option");
                    option.textContent = repo.name;
                    option.value = repo.name;
                    select.appendChild(option);
                });

                // Render bar chart for the first repository by default
                if (repoNameData.length > 0) {
                    await renderBarChart();
                }
            } catch (error) {
                console.error("Error populating dropdown:", error);
            }
        }
    </script>
   
    
</body>

</html>